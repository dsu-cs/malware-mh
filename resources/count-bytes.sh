#!/bin/bash

# help menu for input/parsing args
help() {
	echo "Counts the number of occurances of each unique byte in a file."
	echo 
	echo "Synopsis: ./count-bytes.sh [-a|-h|-x] [file]"
	echo "Options:"
	echo "  a   print out the bytes in ASCII format."
	echo "  h   print this help."
	echo "  x   print out the bytes in hex format (default)"        
	echo 
}

# parse the agruments in
while [[ $# -gt 0 ]]; do
	case $1 in 
		-a)
			format="a"
			shift
			;;
		-x)
			format="x1"
			shift
			;;
		-*)
			help
			exit 1
			;;
		*)
			file="$1"
			shift
			;;
	esac
done

# make sure all arguments are properly set
if [ -z "$file" ] || [ -z "$format" ]; then
	help
	exit 1
fi

# read in the bytes of the file, sort them, count the occurences, and sort descending
od -t $format -w1 -v -An $file | sort | uniq -c | sort -rn 